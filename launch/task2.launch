<launch>
  <!--DEFINE ARGUMENTS-->
  <arg name = "base_path" default = "/root/nen_ws/code/erl_person_classifier/"/>
  <arg name = "rosbag_path" default = "/media/root/F703-CF86/tbm2_00/"/>

  <include file="$(find usb_cam)/launch/usb_cam-test.launch"/>
 
  <!--LAUNCH IMAGE VIEW-->
 <!-- <node pkg="image_view" type="image_view" name="image_view">
    <remap from="image" to="/usb_cam/image_raw" />
  </node>-->
	
  <include file="$(find audio_capture)/launch/capture.launch"/>
      
  <include file="$(find log_nodes)/launch/erl_log_tmb2.launch">
    <arg name="rosbag_path" value="$(arg rosbag_path)" />
  </include>

  <include file="$(find image_diff)/launch/image_diff.launch"/>

  <node pkg="task2_client"
 	type="task2_client"
  	name="task2_client"
  	output="screen"
  	ns="/tiago">

    <!-- device (bell) remapping -->

       <remap from="~/devices_module/bell" to="/roah_rsbb/devices/bell"/>

       <!-- Referee Module -->
          <remap from="~/task2_referee/end_execute"
                   to="/roah_rsbb/end_execute"/>
          <remap from="~/task2_referee/end_prepare"
                    to="/roah_rsbb/end_prepare"/>
          <remap from="~/task2_referee/benchmark_state"
                    to="/roah_rsbb/benchmark/state"/>
          <remap from="~/task2_referee/benchmark"
                   to="/roah_rsbb/benchmark"/>
          <param name="~/task2_referee/poi" value="home"/>

          <rosparam file="$(find task2_client)/config/state_controller.yaml" command="load" ns="task2_referee" />

       <!-- Nav SubModule for Referee Module -->
          <remap from="~/task2_referee/nav_module/move_base"
                   to="/move_base"/>
          <remap from="~/task2_referee/nav_module/move_poi"
                   to="/poi_navigation_server/go_to_poi"/>
          <remap from="~/task2_referee/nav_module/move_waypoint"
                   to="/pal_waypoint/navigate"/>
          <remap from="~/task2_referee/nav_module/odom"
                   to="/mobile_base_controller/odom"/>
          <remap from="~/task2_referee/nav_module/clear_costmaps"
                   to="/move_base/clear_costmaps"/>
          <remap from="~/task2_referee/nav_module/change_map"
                   to="/pal_map_manager/change_map"/>
          <remap from="~/task2_referee/nav_module/set_op_mode"
                   to="/pal_navigation_sm"/>
          <remap from="~/task2_referee/nav_module/move_base_reconf"
                   to="/move_base/PalLocalPlanner/set_parameters"/>

          <rosparam file="$(find task2_client)/config/referee_nav.yaml" command="load" ns="task2_referee/nav_module" />


  <!-- tts remappings -->
  	  <remap from="~/tts_module/tts" to="/tts"/>

          <rosparam file="$(find task2_client)/config/tts.yaml" command="load" ns="tts_module" />


  <!-- navigation remappings -->
      <remap from="~/nav_module/move_base"
               to="/move_base"/>
      <remap from="~/nav_module/move_poi"
               to="/poi_navigation_server/go_to_poi"/>
      <remap from="~/nav_module/move_waypoint"
               to="/pal_waypoint/navigate"/>
      <remap from="~/nav_module/odom"
               to="/mobile_base_controller/odom"/>
      <remap from="~/nav_module/clear_costmaps"
               to="/move_base/clear_costmaps"/>
      <remap from="~/nav_module/change_map"
               to="/pal_map_manager/change_map"/>
      <remap from="~/nav_module/set_op_mode"
               to="/pal_navigation_sm"/>
      <remap from="~/nav_module/move_base_reconf"
               to="/move_base/PalLocalPlanner/set_parameters"/>

      <rosparam file="$(find task2_client)/config/nav.yaml" command="load" ns="nav_module" />

      <!--LOGS-->
      <!-- Log Order -->
      <remap from="~/log_module/log_orders"
               to="/erl_log_base/erl_log_tmb2/log_orders"/>
      <!-- En/Dis Logs -->
      <remap from="~/log_module/en_dis_logs"
               to="/erl_log_base/erl_log_tmb2/en_dis_logs"/>
      <!-- Act Log -->
      <remap from="~/log_module/act_log"
               to="/erl_log_base/erl_log_tmb2/activate_log"/>
      <!-- Topics -->
      <!-- Visitor -->
      <remap from="~/log_module/visitor"
               to="/erl_log_base/erl_log_tmb2/visitor"/>
      <!-- Notification -->
      <remap from="~/log_module/notification"
               to="/erl_log_base/erl_log_tmb2/notification"/>
      <!-- Trajectory -->
      <remap from="~/log_module/path"
               to="/erl_log_base/erl_log_tmb2/path"/>
      <!-- Command -->
      <remap from="~/log_module/command"
               to="/erl_log_base/erl_log_tmb2/command"/>

      <remap from="~/classifier/classify_person"
               to="/erl_person_classifier/classify_person"/>

      <!-- image diff module -->
      <remap from="~/image_diff_module/set_image"
               to="/tiago/image_diff/set_image"/>
      <remap from="~/image_diff_module/change"
               to="/tiago/image_diff/change"/>

      <rosparam file="$(find nen_modules)/config/image_diff_module_default.yaml" command="load" ns="image_diff_module" />

      <!-- head module -->
      <remap from="~/head_module/move_head"
               to="/head_controller/follow_joint_trajectory"/>
      <remap from="~/head_module/point_head"
               to="/head_controller/point_head_action"/>

      <rosparam file="$(find task2_client)/config/head.yaml" command="load" ns="head_module" />

  </node>

  <node pkg="erl_person_classifier" type="erl_person_classifier" name="erl_person_classifier" output="screen">
<!--     <remap from ="erl_person_classifier/front_door_camera" to="/roah_ipcam/image"/> -->
      <remap from ="erl_person_classifier/front_door_camera" to="/usb_cam/image_raw"/>
      <param name="cascade_upper_file" type="string" value="/root/nen_ws/code/erl_person_classifier/xml_files/haarcascade_mcs_upperbody.xml" />
      <param name="cascade_face_file" type="string" value="/root/nen_ws/code/erl_person_classifier/xml_files/haarcascade_frontalface_alt.xml" />
      <param name="known_faces_path" type="string" value="/root/nen_ws/code/erl_person_classifier/person_faces/known_people/" />
      <param name="debug_mode" type="bool" value="False" />
  </node>

   <!-- launch dynamic reconfigure -->
   <node name="rqt_reconfigure" pkg="rqt_reconfigure" type="rqt_reconfigure" respawn="false" output="screen"/>

</launch>
